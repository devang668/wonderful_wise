# 迅飞语音听写项目 - 本地运行说明

## 🎯 项目简介
这是一个基于迅飞语音听写（流式版）WebAPI的语音识别项目，现在已修改为支持本地运行。

## 🚀 快速开始

### 方法一：使用批处理文件（推荐）
1. 双击运行 `start-server.bat`
2. 等待服务器启动
3. 浏览器会自动打开项目页面

### 方法二：使用Python脚本
1. 确保已安装 Python 3.6+
2. 在项目目录下运行：
   ```bash
   python start-server.py
   ```
3. 在浏览器中访问 `http://localhost:8000`

### 方法三：使用其他HTTP服务器
你也可以使用任何HTTP服务器来运行项目：
- **Node.js**: `npx http-server`
- **PHP**: `php -S localhost:8000`
- **Python 2**: `python -m SimpleHTTPServer 8000`

## 🔧 修改说明

### 已修复的问题：
1. **CryptoJS 导入问题**：移除了 `require('crypto-js')`，改为使用浏览器全局变量
2. **Web Worker 路径问题**：将 Web Worker 代码内联到主文件中，使用 Blob URL 创建
3. **同步处理备用方案**：当 Web Worker 失败时，自动切换到同步处理模式
4. **错误处理优化**：改进了错误提示和处理逻辑

### 新增功能：
- 自动检测并处理 Web Worker 创建失败的情况
- 提供同步音频处理作为备用方案
- 更友好的错误提示信息

## 📁 项目结构
```
VoiceDictation/
├── index.html              # 主页面
├── css/
│   └── base.css           # 样式文件
├── js/
│   ├── xf-voice-dictation.js  # 主要功能文件（已修改）
│   ├── crypto-js.min.js   # 加密库
│   └── transcode.worker.js    # Web Worker（已内联）
├── img/
│   └── voice.png          # 图标文件
├── start-server.py        # Python服务器脚本
├── start-server.bat       # Windows批处理文件
└── 本地运行说明.md        # 本说明文件
```

## ⚠️ 注意事项

1. **浏览器兼容性**：建议使用现代浏览器（Chrome、Firefox、Edge等）
2. **HTTPS要求**：某些浏览器可能需要HTTPS才能访问麦克风
3. **API密钥**：需要有效的迅飞语音听写API密钥
4. **网络连接**：需要网络连接以访问迅飞API服务

## 🐛 故障排除

### 问题1：无法访问麦克风
- 确保浏览器允许访问麦克风
- 尝试使用 `https://localhost:8000` 或 `https://127.0.0.1:8000`
- 检查浏览器权限设置

### 问题2：Web Worker 创建失败
- 项目已自动切换到同步处理模式
- 功能仍然正常，但可能性能稍差

### 问题3：CryptoJS 未定义
- 确保 `crypto-js.min.js` 文件存在且正确加载
- 检查浏览器控制台是否有错误信息

## 📞 技术支持
如果遇到问题，请检查：
1. 浏览器控制台错误信息
2. 网络连接状态
3. API密钥配置是否正确

## 📄 许可证
本项目基于原迅飞语音听写示例修改，仅供学习和测试使用。

