# 🎤 AI语音对话系统

## 🌟 功能特色

这是一个完整的AI语音对话系统，集成了以下功能：

### ✨ 核心功能
- **🎙️ 语音识别**：使用迅飞语音听写API，支持实时语音转文字
- **🤖 AI对话**：集成AI聊天接口，支持智能对话
- **🔊 语音合成**：使用Minimax TTS API，AI回复自动转换为语音播放
- **🎭 角色切换**：支持多种AI角色（可爱小萝莉、超级暖男、孔子学生）
- **📚 历史记录**：完整的对话历史管理，支持清空重置
- **💬 文本聊天**：同时支持文本输入模式

### 🎯 技术特点
- **前后端分离**：前端静态服务器 + 后端Flask API
- **实时交互**：语音识别后自动发送，AI回复自动播放
- **角色管理**：动态切换AI角色，每个角色有独特的性格设定
- **错误处理**：完善的错误提示和异常处理机制
- **响应式设计**：支持桌面和移动设备

## 🚀 快速开始

### 方法一：一键启动（推荐）
1. 双击运行 `start-voice-chat.bat`
2. 等待系统启动完成
3. 浏览器会自动打开语音对话页面

### 方法二：Python脚本启动
1. 确保已安装 Python 3.6+
2. 运行命令：
   ```bash
   python start-voice-chat.py
   ```
3. 访问 `http://localhost:8000/voice-chat.html`

### 方法三：分别启动
1. **启动后端**：
   ```bash
   cd code
   python app_fixed.py
   ```

2. **启动前端**：
   ```bash
   python -m http.server 8000
   ```

3. 访问 `http://localhost:8000/voice-chat.html`

## 📁 项目结构

```
VoiceDictation/
├── voice-chat.html              # 语音对话主页面
├── index.html                   # 原始语音识别页面
├── code/                        # 后端代码
│   ├── app_fixed.py            # Flask后端服务器
│   ├── ai_client.py            # AI客户端
│   ├── prompt.py               # 角色提示词
│   ├── ai_voiice_clean.py      # 文本清理
│   └── templates/
│       └── chat.html           # 文本聊天页面
├── js/
│   ├── xf-voice-dictation.js   # 语音识别核心（已修改）
│   └── crypto-js.min.js        # 加密库
├── css/
│   └── base.css                # 样式文件
├── start-voice-chat.py         # 语音对话启动脚本
├── start-voice-chat.bat        # Windows批处理文件
└── 语音对话系统说明.md         # 本说明文件
```

## 🎮 使用指南

### 语音对话模式
1. **开始对话**：点击"开始语音对话"按钮
2. **说话**：对着麦克风说话，系统会自动识别
3. **AI回复**：AI会以语音形式回复你
4. **角色切换**：在右侧面板选择不同的AI角色
5. **清空历史**：点击"清空对话历史"重新开始

### 文本聊天模式
1. 访问 `http://localhost:8000/index.html`
2. 在输入框中输入文字
3. 点击发送按钮或按回车键
4. AI会以文字形式回复

## 🎭 可用角色

| 角色 | 描述 | 特点 |
|------|------|------|
| 可爱小萝莉 | 元气满满的小萝莉 | 活泼可爱，喜欢表现自己 |
| 超级暖男 | 贴心的暖男 | 温柔体贴，善于倾听和安慰 |
| 孔子学生 | 孔子的学生 | 博学多才，喜欢引用经典 |

## 🔧 技术配置

### 语音识别配置
- **服务商**：迅飞语音听写API
- **支持语言**：中文普通话
- **识别时长**：最长60秒
- **实时性**：流式识别，边说边识别

### 语音合成配置
- **服务商**：Minimax TTS API
- **音色**：中文女声（探索型女孩）
- **格式**：MP3
- **采样率**：32kHz

### AI对话配置
- **服务商**：千牛豆包
- **模型**：支持多种AI模型
- **上下文**：支持多轮对话
- **角色设定**：可自定义角色性格

## ⚠️ 注意事项

### 浏览器要求
- 支持现代浏览器（Chrome、Firefox、Edge等）
- 需要麦克风权限
- 建议使用HTTPS或localhost访问

### 网络要求
- 需要稳定的网络连接
- 需要访问迅飞和Minimax API服务

### 权限设置
- 浏览器需要允许麦克风访问
- 首次使用需要授权录音权限

## 🐛 故障排除

### 常见问题

**Q: 无法访问麦克风**
- A: 检查浏览器权限设置，确保允许麦克风访问
- A: 尝试使用 `https://localhost:8000` 访问

**Q: 语音识别不工作**
- A: 检查网络连接，确保能访问迅飞API
- A: 检查API密钥配置是否正确

**Q: AI回复没有声音**
- A: 检查网络连接，确保能访问Minimax API
- A: 检查浏览器音频权限设置

**Q: 角色切换不生效**
- A: 角色切换会清空当前对话历史
- A: 确保后端服务器正常运行

### 调试方法
1. 打开浏览器开发者工具（F12）
2. 查看控制台错误信息
3. 检查网络请求状态
4. 查看服务器日志输出

## 📞 技术支持

如果遇到问题，请：
1. 检查浏览器控制台错误信息
2. 确认所有服务正常运行
3. 检查网络连接状态
4. 查看本文档的故障排除部分

## 📄 许可证

本项目基于开源组件构建，仅供学习和测试使用。

---

🎉 **享受与AI的语音对话吧！**
